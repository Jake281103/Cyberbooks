{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="order-confirmation">
        <h2>âœ… Order Confirmed!</h2>
        <p class="success-message">Thank you for your purchase!</p>
        
        <div class="order-details">
            <h3>Order Details</h3>
            <p><strong>Order Number:</strong> {{ order.order_number }}</p>
            <p><strong>Date:</strong> {{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
            <p><strong>Status:</strong> {{ order.status }}</p>
            
            <h4>Items Purchased:</h4>
            <table class="order-items-table">
                <thead>
                    <tr>
                        <th>Book</th>
                        <th>Price</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.order_items %}
                        <tr>
                            <td>{{ item.book.title }}</td>
                            <td>${{ "%.2f"|format(item.price) }}</td>
                            <td>
                                {% if order.status == 'completed' %}
                                    <a href="{{ url_for('main.download_book', book_id=item.book_id) }}" class="btn btn-sm btn-success">Download</a>
                                    <a href="{{ url_for('main.add_review', book_id=item.book_id) }}" class="btn btn-sm btn-primary">Review</a>
                                {% elif order.status == 'pending' %}
                                    <span class="text-warning">Payment pending...</span>
                                {% elif order.status == 'failed' %}
                                    <span class="text-danger">Payment failed</span>
                                {% else %}
                                    <span class="text-secondary">N/A</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Total:</strong></td>
                        <td colspan="2"><strong>${{ "%.2f"|format(order.total_amount) }}</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <div class="order-actions">
            <a href="{{ url_for('main.shop') }}" class="btn btn-secondary">Continue Shopping</a>
            <a href="{{ url_for('main.profile') }}" class="btn btn-primary">View All Orders</a>
        </div>
    </div>
</div>
{% endblock %}